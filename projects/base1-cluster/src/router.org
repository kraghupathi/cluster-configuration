#+TITLE:     router.org
#+DATE:      2015-03-09 Mon
#+PROPERTY: session *scratch*
#+PROPERTY: results output
#+PROPERTY: tangle  
#+PROPERTY: exports code
#+DESCRIPTION: Router Server Design Documentation

* Introduction
This document describes the requirements, design and implementation of router server.

* Requirements
** Functional Requirements
  1) Act as a gateway for all other servers.
  2) Routes traffic on port 80/443 forward to  reverse proxy.
  3) Routes traffic on port 53 forward to Public DNS.
  4) Listens on port 22 only from Ansible.

** Security Requirements
  1) Port 22 open only to ansible server.
  2) Ports 80,443,53 and ICMP open for all. These Ports are allowed from anywhere in order to access the labs
     via reverseproxy.
  3) Rate Limiting on all open ports.

* Design 
  1) The following design diagram represents the overall structure of
     the router [[./roles/router/files/router-design-diagram.png]]
 
* Implementation
** Directory Structure
     #+BEGIN_SRC yaml
roles/router
|-- files
|   `-- router-design-diagram.png
|-- handlers
|   |-- handlers.yaml
|   |-- main.org
|   `-- main.org~
|-- meta
|-- tasks
|   |-- main.org
|   `-- tasks.yaml
|-- templates
|   |-- iptables
|   |-- #iptables.org#
|   |-- iptables.org
|   `-- iptables.org~
`-- vars
    |-- main.org
    `-- vars.yaml

     #+END_SRC

** Creation of container with following details:
     #+begin_example
       Base Machine: BASEI
       CTID: 14107
       IPADDRESS: 10.4.14.107 (Private)
       HOSTNAME: router.virtual-labs.ac.in
       OS: CentOS-6.6 
       Platform: x86-64
       Interface: venet0:0
       Other Resources: Default Value
    #+end_example
** Main router yaml file
#+BEGIN_SRC yaml :tangle ../build/router.yaml
---
- hosts: router
  remote_user: root
  roles:
    - common
    - router
#+END_SRC
 

